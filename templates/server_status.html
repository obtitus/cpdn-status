<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01//EN">
<html lang="en">
<head>
    <title>CPDN Server status, latest update {{now}}</title>

<script>
  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

  ga('create', 'UA-2401814-4', 'cakebox.net');
  ga('send', 'pageview');

</script>

    <script type="text/javascript" src="http://www.google.com/jsapi"></script>

    <script type="text/javascript">
      google.load("visualization", "1", {packages:["annotationchart"]});
      google.setOnLoadCallback(drawChart);
      function drawChart() {
        drawReady()
        drawProgress()
      }

      function drawReady() {
	  var data = new google.visualization.DataTable();
	  data.addColumn('datetime', 'Date')
	  {%- for header in data[0][1:-2]: %}
          data.addColumn('number', '{{header}}')
	  {%- endfor %}

	  {%- for row in data[1:]: %}
          data.addRow([new Date({{1000*row[0]}}),
		       {%- for e in row[1:-3]: -%}
		         {{e}},
		       {%- endfor -%}
		       {{row[-3]}}])
	  {%- endfor %}
      
          var options = {
              title: 'Ready to send',
              hAxis: {title: 'Date',  titleTextStyle: {color: '#333'}},
              vAxis: {minValue: 0},
              isStacked: true,
              explorer: {},
	      // Allow multiple simultaneous selections.
	      selectionMode: 'multiple',
	      // Group selections by x-value.
	      aggregationTarget: 'category',
	      areaOpacity: 1,
	      focusTarget: 'category'
          };
	  
	  var chart = new google.visualization.AreaChart(document.getElementById("chart_ready"));
	  chart.draw(data, options);
      }	  
      function drawProgress() {
	  var data = new google.visualization.DataTable();
	  data.addColumn('datetime', 'Date')
	  {%- for header in data[0][-1:]: %}
          data.addColumn('number', '{{header}}')
	  {%- endfor %}
	  
	  {%- for row in data[1:]: %}
          data.addRow([new Date({{1000*row[0]}}), {{row[-1]}},])
	  {%- endfor %}
	  
          var options = {
              title: 'In progress',
              hAxis: {title: 'Date',  titleTextStyle: {color: '#333'}},
		  <!-- vAxis: {minValue: 0}, -->
		  isStacked: true,
              explorer: {}
          };
	  
	  var chart = new google.visualization.LineChart(document.getElementById("chart_progress"));
	  chart.draw(data, options);
      }
    </script>

</head>
<body>
  <h1>CPDN Server status, latest update {{now}}</h1>
  <table>
    {%- for row in table %}
    <tr>
      {%- for column in row %}
      <td>{{ column }}</td>
      {%- endfor %}
    </tr>
    {%- endfor %}
  </table>
</body>

<div id="chart_ready" style="width: 900px; height: 400px;"></div>
<div id="chart_progress" style="width: 900px; height: 400px;"></div>

</html>
